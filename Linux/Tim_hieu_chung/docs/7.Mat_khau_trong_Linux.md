# Thiết lập mật khẩu an toàn trên Linux  
Tất cả các thiết lập về mật khẩu an toàn trên Linux đều được lưu tại file /etc/login.defs. Ta cấu hình file /etc/login.defs và thực hiện các chính sách về mật khẩu :  
1. Thiết lập số ngày hết hạn mật khẩu :  
- Số ngày mà người dùng phải thay đổi mật khẩu tính từ lần thay đổi password gần nhất .  
```
PASS_MAX_DAYS 60
```  
<img src="../img/7_1.png">  
2. Thiết lập thời gian tồn tại của mật khẩu:  

- Khoảng thời gian ngắn nhất để có thể thay đổi password của một tài khoản :
```
PASS_MIN_DAYS 2
```  
<img src="../img/7_2.png">  

3. Cảnh báo thời gian hết hạn :

Thiết lập số ngày cảnh báo trước khi mật khẩu hết hạn.
```
PASS_WARN_AGE 7
```  
<img src="../img/7_3.png">  

- Tạo user mới và kiểm tra bằng lệnh :  

```
chage -l username
```  
<img src="../img/7_4.png">  

## NOTE : 
- 3 thiết lập trên chỉ có thể áp dụng với những user mới . Những user cũ muốn thay đổi cần dùng lệnh `chage`  


4. Giới hạn mật khẩu đã được đặt trước đó
- Giới hạn  sử dụng password cũ. Người dùng không thể thiết lập password giống số password cũ được qui định. Ví dụ set remember bằng 5 sẽ không cho user dùng lại 5 password cũ đã đặt  
- Cấu hình bằng file `/etc/pam.d/system-auth` :  
```
password     sufficient     pam_unix.so sha512 shadow nullok try_first_pass
use_authtok remember=5
```   
5. Thiết lập độ dài mật khẩu ngắn nhất#

Thiết lập độ dài ngắn nhất của mật khẩu. Người dùng không thể đặt mật khẩu ngắn hơn số ký tự quy định.

Thiết lập mật khẩu ngắn nhất là 8 kí tự:
```
authconfig --passminlen=8 --update
```  
6. Thiết lập độ phức tạp trong password :  
Trong Linux có các class kí tự như sau : UpperCase / LowerCase / Digits / Others. Độ phức tạp của mật khẩu được thiết lập theo số class xuất hiện trong mật khẩu.

Cấu hình mật khẩu phải xuất hiện ít nhất 2 class:
```
authconfig --passminclass=2 --update
```  
7. Thiết lập số lần lặp kí tự#

Thiết lập số lần lặp tối đa của một ký tự liền kề đối với password mới.

Cấu hình tối da cho phép 2 kí tự lặp nhau:
```
authconfig --passmaxrepeat=2 --update
```
8. Thiết lập độ phức tạp đối với mật khẩu mới.#

Yêu cầu có ít nhất một ký tự thường :
```
authconfig --enablereqlower --update
```
Yêu cầu có ít nhất một ký tự in hoa :
```
authconfig --enablerequpper --update
```
Yêu cầu có ít nhất một ký tự số :
```
authconfig --enablereqdigit --update
```
